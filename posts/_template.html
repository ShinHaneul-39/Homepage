<!DOCTYPE html>
<html lang="ko">
  <head>
    <!-- AI-MAINTENANCE: This template includes AI anchors for future automated edits.
         Do NOT remove: data-ai-* attributes on .post-content, AI-EXAMPLE-SECTION comments,
         and @@CONTENT_START@@/@@CONTENT_END@@ markers. -->
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta name="description" content="@@DESCRIPTION@@" />
    <title>@@TITLE@@ - 신하늘</title>
    <meta property="og:title" content="@@TITLE@@ - 신하늘" />
    <meta property="og:description" content="@@DESCRIPTION@@" />
    <meta property="og:site_name" content="신하늘" />
    <meta property="og:type" content="article" />
    <meta property="og:image" content="@@OG_IMAGE@@" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Pretendard:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <!-- Theme Init (Flash Prevention) -->
    <script src="../assets/js/theme-init.js"></script>
    <link rel="stylesheet" href="../assets/css/main.css" />
  </head>
  <body>
    <!-- Header -->
    <header id="site-header"></header>

    <main>
      <section class="section">
        <div class="container">
          <article class="post-card post-full" aria-label="@@TITLE@@">
            <header>
              <h1 class="post-title">@@TITLE@@</h1>
              <div class="post-meta">@@CATEGORY@@ · @@DATE@@</div>
              <p class="post-subtitle">@@SUBTITLE@@</p>
            </header>
            <figure class="thumb">
              <picture>
                <source srcset="@@THUMB_SRC@@" type="image/jpeg" />
                <img
                  src="../assets/images/embed_image.png"
                  alt="@@THUMB_ALT@@"
                  onerror="this.onerror=null; this.src='../assets/images/embed_image.png';"
                />
              </picture>
            </figure>
            <div class="post-content" data-markdown data-ai-anchor="md-example" data-ai-managed="true" data-ai-version="2025-09-27">
              <!-- @@CONTENT_START@@ -->
              <!-- AI-EXAMPLE-SECTION:START id=md-example v=2025-09-27 -->
<!-- STRUCTURE-GUIDE: 이 템플릿은 사용자가 보내주신 원문을 그대로 렌더링합니다. 아래 구조를 참고하세요. (화면에 표시되지 않는 안내) -->
<!--
# 제목(H1)
## 요약 또는 부제(H2, 선택)
### 소주제(H3, 선택)
본문 내용 작성...
-->
<!-- MARKDOWN-GUIDE: 최소 가이드 (화면 비표시)
- 헤딩: #, ##, ### (#### 이상은 자동으로 ###로 클램프)
- 밑줄: __내용__ (커스텀 밑줄)
- 작은 문단: -# 로 시작하는 줄 → <p class="text-sm">
- 리스트: 공백 2~4칸 들여쓰기(1단계 disc, 2단계 이상 circle)
- 코드 블록: ```언어 ... ```
- 인용문: > 문장
- 링크/이미지: [텍스트](URL), ![대체텍스트](경로)
-->
<!-- AI-EXAMPLE-SECTION:END id=md-example -->
<!-- @@CONTENT_END@@ -->
            </div>
          </article>
        </div>
      </section>
    </main>

    <!-- Footer -->
    <footer id="site-footer"></footer>

    <script src="../assets/js/components.js"></script>
    <script src="../assets/js/main.js" defer></script>
    <script>
        // Force immediate execution of component rendering
        if (typeof ComponentManager !== 'undefined') {
            new ComponentManager();
        }
    </script>
    <!-- Markdown renderer: marked.js + DOMPurify + PrismJS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-css.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify/dist/purify.min.js"></script>
    <script>
      document.addEventListener('DOMContentLoaded', function () {
        // Configure marked options
        marked.setOptions({
          highlight: function(code, lang) {
            if (Prism.languages[lang]) {
              return Prism.highlight(code, Prism.languages[lang], lang);
            } else {
              return code;
            }
          },
          breaks: true,
          gfm: true
        });

        function stripIndent(str) {
          const text = String(str || '')
            .replace(/^\uFEFF/, '')
            .replace(/\r\n/g, '\n')
            .replace(/^\n+|\n+$/g, '');
          const lines = text.split('\n');
          let min = null;
          for (const line of lines) {
            if (!line.trim()) continue;
            const m = line.match(/^(\s+)/);
            if (m) {
              const len = m[1].length;
              if (min === null || len < min) min = len;
            } else {
              min = 0;
              break;
            }
          }
          if (min && min > 0) {
            return lines.map((l) => l.slice(min)).join('\n');
          }
          return text;
        }
    
        function transformCustom(md) {
          // 1) 커스텀 밑줄: __내용__ -> <u>내용</u>
          let text = String(md || '').replace(/__([^\n_]+?)__/g, '<u>$1</u>');
          
          // 2) 헤딩 레벨 제한 제거 (H1~H3 지원 요청에 따라)
          // 기존 #### 제한 로직은 마크다운 표준을 따르도록 marked.js에 위임하거나
          // 디자인 가이드에 따라 H4 이상을 H3로 변환하는 로직 유지 가능.
          // 여기서는 H1~H3가 정상 동작해야 하므로 별도 제한 없이 marked가 처리하도록 둠.
          // 단, 코드 블록 내부 보호 로직은 유지.
          
          // 3) 작은 문단: '-# ' 줄을 <p class="text-sm">로 변환
          text = text
            .split('\n')
            .map((line) => {
              const m = line.match(/^\s*-\#\s+(.*)$/);
              return m ? `<p class="text-sm">${m[1]}</p>` : line;
            })
            .join('\n');
            
          // 4) 다중 인용문 (>>>) 지원
          // marked는 기본적으로 > 중첩을 지원하지만 >>> 문법은 비표준일 수 있음.
          // >>> 를 > > > 로 변환하여 표준 마크다운 중첩 인용으로 처리
          text = text.replace(/^>>>\s/gm, '> > > ');
          
          return text;
        }
    
        const containers = document.querySelectorAll('.post-content[data-markdown]');
        containers.forEach(function (el) {
          const raw = el.textContent || '';
          const md = transformCustom(stripIndent(raw));
          if (!md.trim()) return;
          const html = DOMPurify.sanitize(marked.parse(md));
          el.innerHTML = html;
          el.classList.add('rendered');
          
          // Apply syntax highlighting after rendering
          if (window.Prism) {
            el.querySelectorAll('pre code').forEach((block) => {
              Prism.highlightElement(block);
            });
          }
        });
      });
    </script>
  </body>
</html>